language: python
dist: xenial
python:
  - "2.7"
  - "3.8"
virtualenv:
  system_site_packages: false
before_install:
  - "sudo apt-get update -qq"
  - "sudo apt-get install python-dev python-pip -y"
install:
  - "pip install -r elodie/tests/requirements.txt"
  - "pip install -r elodie/plugins/googlephotos/requirements.txt"
  - "pip install coveralls"
before_script:
  - "mkdir ~/.elodie"
  - "sed 's/your-api-key-goes-here/x8wQLqGhW7qK3sFpjYtVTogVtoMK0S8s/g' config.ini-sample > ~/.elodie/config.ini"
  - "sed -i.bak 's/debug = False/debug = True/g' elodie/constants.py"
  # Get exiftool 10.20 installed
  - "export ELODIE_DIR=${PWD}"
  - "wget http://www.sno.phy.queensu.ca/~phil/exiftool/Image-ExifTool-11.50.tar.gz"
  - "gzip -dc Image-ExifTool-11.50.tar.gz  | tar -xf -"
  - "cd Image-ExifTool-11.50"
  - "perl Makefile.PL"
  - "sudo make install"
  - "cd ${ELODIE_DIR}"
after_success:
  - "coveralls"
script:
  - "./elodie/tests/run_tests.py -w elodie/tests --with-coverage --cover-package=elodie"
